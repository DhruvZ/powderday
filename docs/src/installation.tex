\section{Overview}

We are working on an all-in-one installer script for \pd \ that will
work on a variety of platforms.  For the time being, for better or
worse, the installation is manual.  The fundamental packages you will
need to have installed are:
\begin{enumerate}
\item \yt 
\item Python Dependencies (listed below)
\item \hyperion
\item \fsps
\item \pfsps
\end{enumerate}

Here, we'll detail the rough order of operations, though it's always
wise to check the parent website (referenced in each subsection) for
details.

\subsection{\yt \ installation}
The parent website is \url{http://yt-project.org}.  There, you will
find at \url{http://yt-project.org/\#getyt} a variety of ways to
install \yt.  We recommend the Development branch, though \pd \ is
currently known to work with the Stable branch.  Note - the Legacy
branch of \yt \ is incompatible with \pd.  You can either install from
the install scripts, or use conda or pip. Note that to use \yt, you
will either need to activate \yt \ via:
\begin{verbatim}
 > source YT\_DEST/bin/activate
\end{verbatim}
or, in your .bashrc:\\
\begin{verbatim}
export PATH = \$HOME/yt-x86_64/bin:\$PATH
\end{verbatim}
By doing this, the python you use (and install packages to,
subsequently) will be the \yt \ python.  If you don't want this to
happen, just ensure that the yt packages are in your python path, and
install the forthcoming packages to whichever python distribution you
would like.



\subsection{Python Dependencies}

\pd \ depends on both \scipy, \astropy, and {\sc ATpy}.  The easiest way to
install these is with pip, following:
\begin{verbatim}
 > pip install scipy 
 > pip install astropy
 > pip install atpy
\end{verbatim}
You can also install them straight from source, which you can get from
\url{http://scipy.org}, and \url{http://astropy.org}.

\subsection{\hyperion \ Installation}
The \hyperion \ installation is described in full on the \hyperion
\ website, and therefore we direct you there:
\url{http://docs.hyperion-rt.org/en/stable/installation/installation.html}
for this.  Note, Tom Robitaille's general host website for \hyperion \ is at:
\url{http://www.hyperion-rt.org}. A few notes:
\begin{itemize}
\item First install the Fortran code dependencies: \url{http://docs.hyperion-rt.org/en/stable/installation/fortran_dependencies.html}
\item Second, install any remaining python dependencies:
  \url{http://docs.hyperion-rt.org/en/stable/installation/python_dependencies.html}.
  Note, if you're using the python that comes with \yt, then you
  should already have all of these installed.
\item Finally, install \hyperion \ itself: \url{http://docs.hyperion-rt.org/en/stable/installation/installation.html#hyperion}
\item Make sure that all of the tests that the \hyperion \ installation page suggests actually work (i.e. when you type:
\begin{verbatim}
>hyperion\_sph
\end{verbatim}
you get something like:
\begin{verbatim}
Usage: hyperion input\_file output\_file
\end{verbatim}
\end{itemize}

\subsection{\hyperion \ Dust Files}
Unless you've written your own dust files (a tutorial for which will
come later in this manual), you might want to use the pre-compiled
dust files that are developed by Tom Robitaille (though don't ship
with \hyperion).  To install these, download and install from
\url{http://docs.hyperion-rt.org/en/stable/dust/dust.html}.


\subsection{\fsps}
\fsps \ is hosted at google code, and can be checked out with:
\begin{verbatim}
> svn checkout http://fsps.googlecode.com/svn/trunk/ fsps
\end{verbatim}
and directions to the installation are in the Manual:
\url{https://www.cfa.harvard.edu/~cconroy/FSPS_files/MANUAL.pdf}.
Note, Charlie Conroy's host website for \fsps \ is at:
\url{https://www.cfa.harvard.edu/~cconroy/FSPS.html}.

While \pd \ (more accurately, it's dependencies on \pfsps) may
work with the most current version of \fsps, they are only known to
work for \fsps \ revisison 143.  Therefore, it is safest to revert to
this revision with:
\begin{verbatim}
>svn update -r 143
\end{verbatim}
Note that the SPS\_HOME environment variable must be set in your path
to point to the \fsps/src directory.  For example, in my .bashrc, I have:
\begin{verbatim}
>export SPS\_HOME=/Users/dnarayanan/fsps/
\end{verbatim}
\subsection{\pfsps}
\pd \ depends on python hooks for \fsps \ written by Dan
Foreman-Mackey and others, hosted at:
\url{http://dan.iel.fm/python-fsps/current/installation/}.  
For \pfsps, there is a pip installer that will allow you to install via:
\begin{verbatim}
>pip install fsps
\end{verbatim}
Though you cuold also install the development version with:
\begin{verbatim}
git clone https://github.com/dfm/python-fsps.git
cd python-fsps
python setup.py install
\end{verbatim}

\subsection{TroubleShooting}

So far, the aforementioned has been known to work for Mac OS X, Ubuntu
and CentOS linux operating systems. Of course, troubles are potential.
Here are a few issues that we've come across with possible solutions.

\subsubsection{\fsps \ and \fsps}

\color{red}{\bf Problem}: \color{black} \pfsps \ has an error related to 'fPIC' when installing.\\
\color{blue} {\bf Solution}: \color{black} try include that flag in the FSPS makefile. You can do this by adding -fPIC to the F90FLAGS in the Makefile for FSPS, i.e.
\begin{verbatim}
>F90FLAGS = -O -cpp -fPIC
\end{verbatim}
in your Makefile.\\
\newline
\color{red} {\bf Problem} \color{black} \pfsps \ gives errors related to f2py when installing \\
\color{blue} {\bf Solution} \color{black} To install python-fsps, you
need to have f2py installed. If you're using the \yt \ python, this comes with the \yt \ installation, but
is named f2py2.7 and is in (e.g.)
\begin{verbatim}
\Users/desika/yt-x86_64/bin
\end{verbatim}
So, simply go to that directory and:
\begin{verbatim}
> ln -s f2py2.7 f2py
\end{verbatim}
You additionally need to go to: 
\begin{verbatim}
>cd  yt-x86_64/lib/python2.7/site-package
> ln -s numpy/f2py/ f2py
\end{verbatim}


\subsection{\hyperion}

\color{red}{\bf Problem}: \color{black} \hyperion \ gives an error like:
\begin{verbatim}
ld: library not found for -lcrt1.10.5.o
\end{verbatim}
when compiling (particularly with Mac OS X)\\
\color{blue} {\bf Solution}: \color{black} It could be that there are issues with the command line tools installation (which has cropped up especially for the Mavericks OS).  Try:
\begin{verbatim}
>sudo xcode-select --install
\end{verbatim}
(assuming you have xcode installed already).  This will downlad and
install the command line tools.

\subsection{\pd}
\color{red}{\bf Problem}: \color{black} Memory Errors at the beginning of the Peeled Images setup\\
\color{blue} {\bf Solution}: \color{black} Change the track\_origin from detailed to basic in pd\_front\_end.py

